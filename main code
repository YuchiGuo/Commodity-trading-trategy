import pandas as pd
import numpy as np


def find_optimal_transport(C, G, P):
    # Add your code below
    
    N = len(C)
    from_city = []
    to_city = []
    profit = []
    amount = []
    for x in range(N):
        for y in range(N):
            a = C[y][0]-C[x][1]-G[x,y]
            if a >0:
                from_city.append(x)
                to_city.append(y)
                profit.append(a*(1-P[x,y]))
    
    sorted_indices = np.argsort(profit)
    sorted_indices_list = sorted_indices.tolist()
    sorted_indices_list.reverse() 
    transportation_plan = []
    for max_index in sorted_indices_list: 
        #eg it's from x to y
        c = min(C[from_city[max_index]][3],C[to_city[max_index]][2])
        amount.append(c)
        C[from_city[max_index]][3] -= c 
        C[to_city[max_index]][2] -= c
        transportation_plan.append([from_city[max_index],to_city[max_index],c])
    return np.array(transportation_plan)
   
